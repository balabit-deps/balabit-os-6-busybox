From d9503224c8a93a30b0c8627084b2744d3ee6f403 Mon Sep 17 00:00:00 2001
From: Natanael Copa <ncopa@alpinelinux.org>
Date: Fri, 30 Mar 2018 20:18:12 +0200
Subject: cpio: extract "unsafe" symlinks the same way tar/unzip does

function                                             old     new   delta
cpio_main                                            588     596      +8

Signed-off-by: Natanael Copa <ncopa@alpinelinux.org>
Signed-off-by: Denys Vlasenko <vda.linux@googlemail.com>
---
 archival/cpio.c | 2 ++
 1 file changed, 2 insertions(+)

Index: busybox-1.22.0/archival/cpio.c
===================================================================
--- busybox-1.22.0.orig/archival/cpio.c	2019-03-06 13:30:56.434970169 -0500
+++ busybox-1.22.0/archival/cpio.c	2019-03-06 13:30:56.434970169 -0500
@@ -480,6 +480,8 @@ int cpio_main(int argc UNUSED_PARAM, cha
 	while (get_header_cpio(archive_handle) == EXIT_SUCCESS)
 		continue;
 
+	create_symlinks_from_list(archive_handle->symlink_placeholders);
+
 	if (archive_handle->cpio__blocks != (off_t)-1
 	 && !(opt & OPT_QUIET)
 	) {
